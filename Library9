

local ModMenu = {}
ModMenu.__index = ModMenu

-- –°–µ—Ä–≤–∏—Å—ã
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local HttpService = game:GetService("HttpService")
local Lighting = game:GetService("Lighting")

-- –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
local PLAYER = Players.LocalPlayer
local IS_MOBILE = UserInputService.TouchEnabled

-- –£—Ç–∏–ª–∏—Ç—ã
local function Create(className, properties)
    local obj = Instance.new(className)
    for prop, value in pairs(properties) do
        if prop ~= "Parent" then
            obj[prop] = value
        end
    end
    if properties.Parent then
        obj.Parent = properties.Parent
    end
    return obj
end

local function Tween(obj, properties, duration)
    local tweenInfo = TweenInfo.new(duration or 0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local tween = TweenService:Create(obj, tweenInfo, properties)
    tween:Play()
    return tween
end

local function Round(num, decimal)
    local mult = 10^(decimal or 0)
    return math.floor(num * mult + 0.5) / mult
end

-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å
function ModMenu.new(menuName)
    local self = setmetatable({}, ModMenu)
    
    self.MenuName = menuName or "ModMenu"
    self.Version = "3.1"
    self.GUI = nil
    self.Settings = {}
    self.Connections = {}
    self.Elements = {}
    self.Notifications = {}
    self.FloatingTexts = {}
    self.MenuOpen = false
    self.SettingsOpen = false
    
    self.MenuID = "Menu_" .. HttpService:GenerateGUID(false):sub(1, 8)
    
    self:ForceCleanup()
    self:Initialize()
    
    return self
end

-- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
function ModMenu:ForceCleanup()
    -- –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å—Ç–∞—Ä—ã–µ –º–µ–Ω—é
    for _, obj in ipairs(CoreGui:GetChildren()) do
        if obj.Name:find("Menu_") or obj.Name == "ModMenus" then
            obj:Destroy()
        end
    end
end

-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
function ModMenu:Initialize()
    -- –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
    local container = Create("Folder", {
        Name = "ModMenus",
        Parent = CoreGui
    })
    
    -- –°–æ–∑–¥–∞–µ–º ScreenGui
    self.GUI = Create("ScreenGui", {
        Name = self.MenuID,
        Parent = container,
        DisplayOrder = 9999,
        ResetOnSpawn = false
    })
    
    -- –°–æ–∑–¥–∞–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    self:CreateMainButton()
    self:CreateFloatingTexts()
    self:CreateMainMenu()
    self:CreateSettingsWindow()
    
    self.Active = true
    self:Notify("–ú–µ–Ω—é –∑–∞–≥—Ä—É–∂–µ–Ω–æ! v" .. self.Version)
end

-- –°–æ–∑–¥–∞–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏
function ModMenu:CreateMainButton()
    self.MainButton = Create("TextButton", {
        Parent = self.GUI,
        Text = "‚â°",
        Font = Enum.Font.GothamBold,
        TextSize = 28,
        TextColor3 = Color3.new(1, 1, 1),
        BackgroundColor3 = Color3.fromRGB(40, 40, 50),
        BorderSizePixel = 0,
        Size = UDim2.new(0, 50, 0, 50),
        Position = UDim2.new(0, 20, 0.5, -25),
        ZIndex = 1000
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(1, 0),
        Parent = self.MainButton
    })
    
    -- –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ
    self:MakeDraggable(self.MainButton)
    
    -- –ö–ª–∏–∫–∏
    self.MainButton.MouseButton1Click:Connect(function()
        self:ToggleMenu()
    end)
    
    self.MainButton.TouchTap:Connect(function()
        self:ToggleMenu()
    end)
    
    -- –≠—Ñ—Ñ–µ–∫—Ç—ã
    self.MainButton.MouseEnter:Connect(function()
        Tween(self.MainButton, {BackgroundColor3 = Color3.fromRGB(60, 60, 70)})
    end)
    
    self.MainButton.MouseLeave:Connect(function()
        Tween(self.MainButton, {BackgroundColor3 = Color3.fromRGB(40, 40, 50)})
    end)
end

-- –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–≤–∞—é—â–∏—Ö –Ω–∞–¥–ø–∏—Å–µ–π
function ModMenu:CreateFloatingTexts()
    for i = 1, 5 do
        local floatText = Create("TextLabel", {
            Parent = self.GUI,
            Text = "–§–∞—Ç–∏–º–∞ ‚ô•Ô∏è",
            Font = Enum.Font.GothamBold,
            TextSize = 24,
            TextColor3 = Color3.fromRGB(255, 100 + i * 20, 150 + i * 10),
            TextTransparency = 0.3,
            BackgroundTransparency = 1,
            Size = UDim2.new(0, 150, 0, 40),
            Position = UDim2.new(math.random() * 0.8, 0, math.random() * 0.8, 0),
            ZIndex = 900,
            Visible = false
        })
        
        table.insert(self.FloatingTexts, floatText)
        
        -- –ê–Ω–∏–º–∞—Ü–∏—è
        task.spawn(function()
            local startPos = floatText.Position
            local time = math.random() * 10
            local speed = 0.3 + math.random() * 0.4
            
            while floatText and floatText.Parent do
                if not self.MenuOpen and not self.SettingsOpen then
                    time += RunService.Heartbeat:Wait()
                    
                    local x = startPos.X.Offset + math.sin(time * speed) * 80
                    local y = startPos.Y.Offset + math.cos(time * speed * 0.7) * 50
                    
                    floatText.Position = UDim2.new(startPos.X.Scale, x, startPos.Y.Scale, y)
                    
                    -- –ú–µ—Ä—Ü–∞–Ω–∏–µ
                    floatText.TextTransparency = 0.2 + math.sin(time * 1.5) * 0.3
                else
                    task.wait(0.1)
                end
            end
        end)
    end
end

-- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –Ω–∞–¥–ø–∏—Å–µ–π
function ModMenu:UpdateFloatingTexts()
    local visible = not (self.MenuOpen or self.SettingsOpen)
    for _, text in ipairs(self.FloatingTexts) do
        if text then
            text.Visible = visible
        end
    end
end

-- –°–æ–∑–¥–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –º–µ–Ω—é
function ModMenu:CreateMainMenu()
    -- –ì–ª–∞–≤–Ω—ã–π —Ñ—Ä–µ–π–º
    self.MenuFrame = Create("Frame", {
        Parent = self.GUI,
        BackgroundColor3 = Color3.fromRGB(20, 20, 25),
        BackgroundTransparency = 0.05,
        BorderSizePixel = 0,
        Size = UDim2.new(0, 600, 0, 400),
        Position = UDim2.new(0.5, -300, 0.5, -200),
        Visible = false,
        ZIndex = 100
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(0, 12),
        Parent = self.MenuFrame
    })
    
    -- Title bar
    local titleBar = Create("Frame", {
        Parent = self.MenuFrame,
        BackgroundColor3 = Color3.fromRGB(30, 30, 40),
        BorderSizePixel = 0,
        Size = UDim2.new(1, 0, 0, 40)
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(0, 12, 0, 0),
        Parent = titleBar
    })
    
    -- –ó–∞–≥–æ–ª–æ–≤–æ–∫
    Create("TextLabel", {
        Parent = titleBar,
        Text = self.MenuName .. " v" .. self.Version,
        Font = Enum.Font.GothamBold,
        TextSize = 18,
        TextColor3 = Color3.new(1, 1, 1),
        BackgroundTransparency = 1,
        Size = UDim2.new(0, 200, 1, 0),
        Position = UDim2.new(0, 15, 0, 0),
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    -- –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
    local closeBtn = Create("TextButton", {
        Parent = titleBar,
        Text = "‚úï",
        Font = Enum.Font.GothamBold,
        TextSize = 24,
        TextColor3 = Color3.fromRGB(255, 100, 100),
        BackgroundTransparency = 1,
        Size = UDim2.new(0, 40, 1, 0),
        Position = UDim2.new(1, -40, 0, 0)
    })
    
    -- –ö–Ω–æ–ø–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
    local settingsBtn = Create("TextButton", {
        Parent = titleBar,
        Text = "‚öô",
        Font = Enum.Font.GothamBold,
        TextSize = 18,
        TextColor3 = Color3.fromRGB(100, 150, 255),
        BackgroundTransparency = 1,
        Size = UDim2.new(0, 40, 1, 0),
        Position = UDim2.new(1, -80, 0, 0)
    })
    
    -- –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ
    self:MakeDraggable(self.MenuFrame, titleBar)
    
    -- –ö–æ–Ω—Ç–µ–Ω—Ç
    local content = Create("Frame", {
        Parent = self.MenuFrame,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, -40),
        Position = UDim2.new(0, 0, 0, 40)
    })
    
    -- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å (—Ç–∞–±—ã)
    self.LeftPanel = Create("ScrollingFrame", {
        Parent = content,
        BackgroundColor3 = Color3.fromRGB(25, 25, 35),
        BorderSizePixel = 0,
        Size = UDim2.new(0, 150, 1, 0),
        CanvasSize = UDim2.new(0, 0, 0, 0),
        ScrollBarThickness = 3,
        ScrollBarImageColor3 = Color3.fromRGB(100, 150, 255)
    })
    
    local leftList = Create("UIListLayout", {
        Parent = self.LeftPanel,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 5)
    })
    
    leftList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        self.LeftPanel.CanvasSize = UDim2.new(0, 0, 0, leftList.AbsoluteContentSize.Y + 10)
    end)
    
    -- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å (–∫–æ–Ω—Ç–µ–Ω—Ç)
    self.RightPanel = Create("ScrollingFrame", {
        Parent = content,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -160, 1, 0),
        Position = UDim2.new(0, 160, 0, 0),
        CanvasSize = UDim2.new(0, 0, 0, 0),
        ScrollBarThickness = 3,
        ScrollBarImageColor3 = Color3.fromRGB(100, 150, 255)
    })
    
    local rightList = Create("UIListLayout", {
        Parent = self.RightPanel,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 10)
    })
    
    rightList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        self.RightPanel.CanvasSize = UDim2.new(0, 0, 0, rightList.AbsoluteContentSize.Y + 20)
    end)
    
    -- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
    closeBtn.MouseButton1Click:Connect(function()
        self:ToggleMenu()
    end)
    
    settingsBtn.MouseButton1Click:Connect(function()
        self:ToggleSettings()
    end)
    
    -- –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
    if IS_MOBILE then
        self.MenuFrame.Size = UDim2.new(0.9, 0, 0.8, 0)
        self.MenuFrame.Position = UDim2.new(0.05, 0, 0.1, 0)
    end
    
    -- –î–æ–±–∞–≤–ª—è–µ–º –±–∞–∑–æ–≤—ã–µ —Ç–∞–±—ã
    self:AddDefaultTabs()
end

-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
function ModMenu:AddDefaultTabs()
    local tabs = {
        {"–ì–ª–∞–≤–Ω–∞—è", "üè†"},
        {"–ò–≥—Ä–æ–∫", "üë§"},
        {"–í–∏–∑—É–∞–ª", "üëÅÔ∏è"},
        {"–ú–∏—Ä", "üåç"},
        {"–î—Ä—É–≥–æ–µ", "‚öôÔ∏è"}
    }
    
    for i, tabData in ipairs(tabs) do
        self:AddTab(tabData[1], tabData[2])
    end
end

-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–∞
function ModMenu:AddTab(name, icon)
    -- –ö–Ω–æ–ø–∫–∞ —Ç–∞–±–∞
    local tabButton = Create("TextButton", {
        Parent = self.LeftPanel,
        Text = "   " .. icon .. " " .. name,
        Font = Enum.Font.Gotham,
        TextSize = 14,
        TextColor3 = Color3.new(1, 1, 1),
        TextXAlignment = Enum.TextXAlignment.Left,
        BackgroundColor3 = Color3.fromRGB(40, 40, 50),
        BorderSizePixel = 0,
        Size = UDim2.new(1, -10, 0, 35),
        LayoutOrder = #self.LeftPanel:GetChildren(),
        AutoButtonColor = false
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(0, 6),
        Parent = tabButton
    })
    
    -- –ö–æ–Ω—Ç–µ–Ω—Ç —Ç–∞–±–∞
    local contentFrame = Create("Frame", {
        Parent = self.RightPanel,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 0),
        LayoutOrder = #self.RightPanel:GetChildren(),
        Visible = false
    })
    
    local contentList = Create("UIListLayout", {
        Parent = contentFrame,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 10)
    })
    
    contentList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        contentFrame.Size = UDim2.new(1, 0, 0, contentList.AbsoluteContentSize.Y)
    end)
    
    -- –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø–µ—Ä–≤—ã–π —Ç–∞–±
    if #self.LeftPanel:GetChildren() == 1 then
        tabButton.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
        contentFrame.Visible = true
        self.ActiveTab = name
    end
    
    -- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
    local function OnTabClick()
        -- –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ —Ç–∞–±—ã
        for _, child in ipairs(self.LeftPanel:GetChildren()) do
            if child:IsA("TextButton") then
                child.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
            end
        end
        
        -- –°–∫—Ä—ã–≤–∞–µ–º –≤–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç
        for _, child in ipairs(self.RightPanel:GetChildren()) do
            if child:IsA("Frame") then
                child.Visible = false
            end
        end
        
        -- –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π
        tabButton.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
        contentFrame.Visible = true
        self.ActiveTab = name
    end
    
    tabButton.MouseButton1Click:Connect(OnTabClick)
    tabButton.TouchTap:Connect(OnTabClick)
    
    -- –≠—Ñ—Ñ–µ–∫—Ç—ã –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
    tabButton.MouseEnter:Connect(function()
        if self.ActiveTab ~= name then
            Tween(tabButton, {BackgroundColor3 = Color3.fromRGB(50, 50, 60)})
        end
    end)
    
    tabButton.MouseLeave:Connect(function()
        if self.ActiveTab ~= name then
            Tween(tabButton, {BackgroundColor3 = Color3.fromRGB(40, 40, 50)})
        end
    end)
    
    return contentFrame
end

-- –°–æ–∑–¥–∞–Ω–∏–µ –æ–∫–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
function ModMenu:CreateSettingsWindow()
    self.SettingsFrame = Create("Frame", {
        Parent = self.GUI,
        BackgroundColor3 = Color3.fromRGB(20, 20, 25),
        BackgroundTransparency = 0.05,
        BorderSizePixel = 0,
        Size = UDim2.new(0, 700, 0, 500),
        Position = UDim2.new(0.5, -350, 0.5, -250),
        Visible = false,
        ZIndex = 200
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(0, 12),
        Parent = self.SettingsFrame
    })
    
    -- Title bar
    local titleBar = Create("Frame", {
        Parent = self.SettingsFrame,
        BackgroundColor3 = Color3.fromRGB(30, 30, 40),
        BorderSizePixel = 0,
        Size = UDim2.new(1, 0, 0, 40)
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(0, 12, 0, 0),
        Parent = titleBar
    })
    
    Create("TextLabel", {
        Parent = titleBar,
        Text = "–ù–∞—Å—Ç—Ä–æ–π–∫–∏",
        Font = Enum.Font.GothamBold,
        TextSize = 18,
        TextColor3 = Color3.new(1, 1, 1),
        BackgroundTransparency = 1,
        Size = UDim2.new(0, 200, 1, 0),
        Position = UDim2.new(0, 15, 0, 0),
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    local closeBtn = Create("TextButton", {
        Parent = titleBar,
        Text = "‚úï",
        Font = Enum.Font.GothamBold,
        TextSize = 24,
        TextColor3 = Color3.fromRGB(255, 100, 100),
        BackgroundTransparency = 1,
        Size = UDim2.new(0, 40, 1, 0),
        Position = UDim2.new(1, -40, 0, 0)
    })
    
    -- –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ
    self:MakeDraggable(self.SettingsFrame, titleBar)
    
    -- –ö–æ–Ω—Ç–µ–Ω—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫
    local content = Create("ScrollingFrame", {
        Parent = self.SettingsFrame,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, -40),
        Position = UDim2.new(0, 0, 0, 40),
        CanvasSize = UDim2.new(0, 0, 0, 0),
        ScrollBarThickness = 3,
        ScrollBarImageColor3 = Color3.fromRGB(100, 150, 255)
    })
    
    local list = Create("UIListLayout", {
        Parent = content,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 15)
    })
    
    list:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        content.CanvasSize = UDim2.new(0, 0, 0, list.AbsoluteContentSize.Y + 20)
    end)
    
    -- –°–æ–∑–¥–∞–µ–º —Å–µ–∫—Ü–∏–∏
    self:CreateSettingsSections(content)
    
    -- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è
    closeBtn.MouseButton1Click:Connect(function()
        self:ToggleSettings()
    end)
    
    closeBtn.TouchTap:Connect(function()
        self:ToggleSettings()
    end)
    
    -- –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
    if IS_MOBILE then
        self.SettingsFrame.Size = UDim2.new(0.95, 0, 0.9, 0)
        self.SettingsFrame.Position = UDim2.new(0.025, 0, 0.05, 0)
    end
end

-- –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–∫—Ü–∏–π –Ω–∞—Å—Ç—Ä–æ–µ–∫
function ModMenu:CreateSettingsSections(container)
    -- –¶–≤–µ—Ç–∞ –º–µ–Ω—é
    local colorsSection = self:CreateSection("–¶–≤–µ—Ç–∞ –º–µ–Ω—é", container)
    self:ColorPicker(colorsSection, "–û—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç", Color3.fromRGB(100, 150, 255), function(color)
        self:Notify("–¶–≤–µ—Ç –∏–∑–º–µ–Ω–µ–Ω")
    end)
    
    self:Slider(colorsSection, "–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å", 0, 100, 5, 1, function(value)
        self.MenuFrame.BackgroundTransparency = value / 100
        self.SettingsFrame.BackgroundTransparency = value / 100
    end)
    
    -- –ò–≥—Ä–æ–∫
    local playerSection = self:CreateSection("–ò–≥—Ä–æ–∫", container)
    self:Toggle(playerSection, "–ë–µ—Å—Å–º–µ—Ä—Ç–∏–µ", false, function(value)
        if PLAYER.Character then
            local humanoid = PLAYER.Character:FindFirstChild("Humanoid")
            if humanoid then
                humanoid.Health = value and math.huge or 100
            end
        end
        self:Notify("–ë–µ—Å—Å–º–µ—Ä—Ç–∏–µ: " .. (value and "–í–ö–õ" or "–í–´–ö–õ"))
    end)
    
    self:Slider(playerSection, "–°–∫–æ—Ä–æ—Å—Ç—å", 16, 500, 16, 1, function(value)
        if PLAYER.Character then
            local humanoid = PLAYER.Character:FindFirstChild("Humanoid")
            if humanoid then
                humanoid.WalkSpeed = value
            end
        end
    end)
    
    -- –í–∏–∑—É–∞–ª
    local visualSection = self:CreateSection("–í–∏–∑—É–∞–ª", container)
    self:Toggle(visualSection, "–ü–æ–ª–Ω–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ", false, function(value)
        Lighting.GlobalShadows = not value
        Lighting.ClockTime = value and 14 or 12
        self:Notify("–û—Å–≤–µ—â–µ–Ω–∏–µ: " .. (value and "–í–ö–õ" or "–í–´–ö–õ"))
    end)
    
    self:Slider(visualSection, "–Ø—Ä–∫–æ—Å—Ç—å", 0, 10, 1, 0.1, function(value)
        Lighting.Brightness = value
    end)
    
    -- –í—ã–±–æ—Ä –∏–≥—Ä–æ–∫–æ–≤
    local playersSection = self:CreateSection("–ò–≥—Ä–æ–∫–∏", container)
    local playerList = {}
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= PLAYER then
            table.insert(playerList, player.Name)
        end
    end
    
    if #playerList > 0 then
        self:Dropdown(playersSection, "–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞", playerList, playerList[1], function(value)
            self.SelectedPlayer = value
            self:Notify("–í—ã–±—Ä–∞–Ω: " .. value)
        end)
    else
        Create("TextLabel", {
            Parent = playersSection,
            Text = "–ù–µ—Ç –¥—Ä—É–≥–∏—Ö –∏–≥—Ä–æ–∫–æ–≤",
            Font = Enum.Font.Gotham,
            TextSize = 14,
            TextColor3 = Color3.new(0.7, 0.7, 0.7),
            BackgroundTransparency = 1,
            Size = UDim2.new(1, 0, 0, 30),
            TextXAlignment = Enum.TextXAlignment.Center
        })
    end
    
    -- –ü—Ä–µ–¥–º–µ—Ç—ã
    local itemsSection = self:CreateSection("–ü—Ä–µ–¥–º–µ—Ç—ã", container)
    local items = {"–ú–µ—á", "–©–∏—Ç", "–ó–µ–ª—å–µ", "–ö–ª—é—á", "–°—É–Ω–¥—É–∫"}
    self:Dropdown(itemsSection, "–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç", items, items[1], function(value)
        self.SelectedItem = value
        self:Notify("–í—ã–±—Ä–∞–Ω: " .. value)
    end)
end

-- UI –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

-- –°–µ–∫—Ü–∏—è
function ModMenu:CreateSection(title, parent)
    local section = Create("Frame", {
        Parent = parent,
        BackgroundColor3 = Color3.fromRGB(30, 30, 35),
        BackgroundTransparency = 0.1,
        Size = UDim2.new(1, -20, 0, 0),
        LayoutOrder = #parent:GetChildren()
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(0, 8),
        Parent = section
    })
    
    Create("UIPadding", {
        Parent = section,
        PaddingLeft = UDim.new(0, 15),
        PaddingRight = UDim.new(0, 15),
        PaddingTop = UDim.new(0, 10),
        PaddingBottom = UDim.new(0, 10)
    })
    
    Create("TextLabel", {
        Parent = section,
        Text = title,
        Font = Enum.Font.GothamBold,
        TextSize = 16,
        TextColor3 = Color3.new(1, 1, 1),
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 25),
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    local list = Create("UIListLayout", {
        Parent = section,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 8)
    })
    
    list:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        section.Size = UDim2.new(1, -20, 0, list.AbsoluteContentSize.Y + 35)
    end)
    
    return section
end

-- –ö–Ω–æ–ø–∫–∞
function ModMenu:Btn(parent, text, callback)
    local button = Create("TextButton", {
        Parent = parent,
        Text = text,
        Font = Enum.Font.Gotham,
        TextSize = 14,
        TextColor3 = Color3.new(1, 1, 1),
        BackgroundColor3 = Color3.fromRGB(100, 150, 255),
        BorderSizePixel = 0,
        Size = UDim2.new(1, 0, 0, 35),
        LayoutOrder = #parent:GetChildren(),
        AutoButtonColor = false
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(0, 6),
        Parent = button
    })
    
    -- Ripple —ç—Ñ—Ñ–µ–∫—Ç
    local function CreateRipple()
        local ripple = Create("Frame", {
            Parent = button,
            BackgroundColor3 = Color3.new(1, 1, 1),
            BackgroundTransparency = 0.7,
            Size = UDim2.new(0, 0, 0, 0),
            Position = UDim2.new(0.5, 0, 0.5, 0),
            AnchorPoint = Vector2.new(0.5, 0.5)
        })
        
        Create("UICorner", {
            CornerRadius = UDim.new(1, 0),
            Parent = ripple
        })
        
        Tween(ripple, {Size = UDim2.new(2, 0, 2, 0), BackgroundTransparency = 1}, 0.5)
        
        task.spawn(function()
            task.wait(0.5)
            ripple:Destroy()
        end)
    end
    
    -- –û–±—Ä–∞–±–æ—Ç—á–∏–∫
    local function OnClick()
        CreateRipple()
        if callback then
            local success, err = pcall(callback)
            if not success then
                warn("–û—à–∏–±–∫–∞ –≤ –∫–Ω–æ–ø–∫–µ: " .. tostring(err))
            end
        end
    end
    
    button.MouseButton1Click:Connect(OnClick)
    button.TouchTap:Connect(OnClick)
    
    -- –≠—Ñ—Ñ–µ–∫—Ç—ã
    button.MouseEnter:Connect(function()
        Tween(button, {BackgroundColor3 = Color3.fromRGB(120, 170, 255)})
    end)
    
    button.MouseLeave:Connect(function()
        Tween(button, {BackgroundColor3 = Color3.fromRGB(100, 150, 255)})
    end)
    
    return button
end

-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å (–£–ü–†–û–©–ï–ù–ù–´–ô –ò –†–ê–ë–û–ß–ò–ô)
function ModMenu:Toggle(parent, text, state, callback)
    local toggleContainer = Create("Frame", {
        Parent = parent,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 30),
        LayoutOrder = #parent:GetChildren()
    })
    
    local label = Create("TextLabel", {
        Parent = toggleContainer,
        Text = text,
        Font = Enum.Font.Gotham,
        TextSize = 14,
        TextColor3 = Color3.new(1, 1, 1),
        BackgroundTransparency = 1,
        Size = UDim2.new(0.7, 0, 1, 0),
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    local toggleButton = Create("TextButton", {
        Parent = toggleContainer,
        Text = "",
        BackgroundColor3 = state and Color3.fromRGB(100, 150, 255) or Color3.fromRGB(60, 60, 70),
        BorderSizePixel = 0,
        Size = UDim2.new(0, 50, 0, 25),
        Position = UDim2.new(1, -50, 0.5, -12.5),
        AutoButtonColor = false
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(1, 0),
        Parent = toggleButton
    })
    
    local dot = Create("Frame", {
        Parent = toggleButton,
        BackgroundColor3 = Color3.new(1, 1, 1),
        Size = UDim2.new(0, 19, 0, 19),
        Position = state and UDim2.new(1, -22, 0.5, -9.5) or UDim2.new(0, 3, 0.5, -9.5)
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(1, 0),
        Parent = dot
    })
    
    -- –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
    local function ToggleState()
        state = not state
        
        if state then
            Tween(dot, {Position = UDim2.new(1, -22, 0.5, -9.5)})
            Tween(toggleButton, {BackgroundColor3 = Color3.fromRGB(100, 150, 255)})
        else
            Tween(dot, {Position = UDim2.new(0, 3, 0.5, -9.5)})
            Tween(toggleButton, {BackgroundColor3 = Color3.fromRGB(60, 60, 70)})
        end
        
        if callback then
            local success, err = pcall(callback, state)
            if not success then
                warn("–û—à–∏–±–∫–∞ –≤ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ: " .. tostring(err))
            end
        end
    end
    
    -- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
    toggleButton.MouseButton1Click:Connect(ToggleState)
    
    toggleButton.TouchTap:Connect(ToggleState)
    label.TouchTap:Connect(ToggleState)
    
    -- –≠—Ñ—Ñ–µ–∫—Ç—ã
    toggleButton.MouseEnter:Connect(function()
        if state then
            Tween(toggleButton, {BackgroundColor3 = Color3.fromRGB(120, 170, 255)})
        else
            Tween(toggleButton, {BackgroundColor3 = Color3.fromRGB(80, 80, 90)})
        end
    end)
    
    toggleButton.MouseLeave:Connect(function()
        if state then
            Tween(toggleButton, {BackgroundColor3 = Color3.fromRGB(100, 150, 255)})
        else
            Tween(toggleButton, {BackgroundColor3 = Color3.fromRGB(60, 60, 70)})
        end
    end)
    
    return {
        Update = function(value)
            state = value
            if state then
                dot.Position = UDim2.new(1, -22, 0.5, -9.5)
                toggleButton.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
            else
                dot.Position = UDim2.new(0, 3, 0.5, -9.5)
                toggleButton.BackgroundColor3 = Color3.fromRGB(60, 60, 70)
            end
        end,
        GetState = function() return state end
    }
end

-- –°–ª–∞–π–¥–µ—Ä (–ü–†–û–°–¢–û–ô –ò –†–ê–ë–û–ß–ò–ô)
function ModMenu:Slider(parent, text, min, max, value, step, callback)
    local sliderContainer = Create("Frame", {
        Parent = parent,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 50),
        LayoutOrder = #parent:GetChildren()
    })
    
    local top = Create("Frame", {
        Parent = sliderContainer,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 20)
    })
    
    Create("TextLabel", {
        Parent = top,
        Text = text,
        Font = Enum.Font.Gotham,
        TextSize = 14,
        TextColor3 = Color3.new(1, 1, 1),
        BackgroundTransparency = 1,
        Size = UDim2.new(0.7, 0, 1, 0),
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    local valueLabel = Create("TextLabel", {
        Parent = top,
        Text = tostring(value),
        Font = Enum.Font.Gotham,
        TextSize = 14,
        TextColor3 = Color3.fromRGB(100, 150, 255),
        BackgroundTransparency = 1,
        Size = UDim2.new(0.3, 0, 1, 0),
        Position = UDim2.new(0.7, 0, 0, 0),
        TextXAlignment = Enum.TextXAlignment.Right
    })
    
    local track = Create("Frame", {
        Parent = sliderContainer,
        BackgroundColor3 = Color3.fromRGB(60, 60, 70),
        Size = UDim2.new(1, 0, 0, 6),
        Position = UDim2.new(0, 0, 1, -16)
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(1, 0),
        Parent = track
    })
    
    local fill = Create("Frame", {
        Parent = track,
        BackgroundColor3 = Color3.fromRGB(100, 150, 255),
        Size = UDim2.new((value - min) / (max - min), 0, 1, 0)
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(1, 0),
        Parent = fill
    })
    
    local thumb = Create("Frame", {
        Parent = track,
        BackgroundColor3 = Color3.new(1, 1, 1),
        Size = UDim2.new(0, 16, 0, 16),
        Position = UDim2.new((value - min) / (max - min), -8, 0.5, -8)
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(1, 0),
        Parent = thumb
    })
    
    -- –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    local function UpdateValue(newValue)
        newValue = math.clamp(newValue, min, max)
        if step then
            newValue = math.floor(newValue / step + 0.5) * step
        end
        
        value = newValue
        valueLabel.Text = tostring(value)
        
        local percent = (value - min) / (max - min)
        fill.Size = UDim2.new(percent, 0, 1, 0)
        thumb.Position = UDim2.new(percent, -8, 0.5, -8)
        
        if callback then
            local success, err = pcall(callback, value)
            if not success then
                warn("–û—à–∏–±–∫–∞ –≤ —Å–ª–∞–π–¥–µ—Ä–µ: " .. tostring(err))
            end
        end
    end
    
    -- –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ
    local dragging = false
    
    local function UpdateFromInput(input)
        local mousePos = input.Position
        local trackPos = track.AbsolutePosition
        local trackSize = track.AbsoluteSize
        
        local relativeX = (mousePos.X - trackPos.X) / trackSize.X
        relativeX = math.clamp(relativeX, 0, 1)
        
        local newValue = min + relativeX * (max - min)
        UpdateValue(newValue)
    end
    
    -- –ù–∞—á–∞–ª–æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
    local function StartDrag(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or 
           input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            UpdateFromInput(input)
        end
    end
    
    -- –ö–æ–Ω–µ—Ü –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
    local function EndDrag(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or 
           input.UserInputType == Enum.UserInputType.Touch then
            dragging = false
        end
    end
    
    -- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
    track.InputBegan:Connect(StartDrag)
    track.InputEnded:Connect(EndDrag)
    thumb.InputBegan:Connect(StartDrag)
    
    -- –ì–ª–æ–±–∞–ª—å–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º—ã—à–∏
    local mouseMoveConnection = UserInputService.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or 
           input.UserInputType == Enum.UserInputType.Touch) then
            UpdateFromInput(input)
        end
    end)
    
    table.insert(self.Connections, mouseMoveConnection)
    
    -- Touch –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
    track.TouchTap:Connect(function()
        local touchPos = UserInputService:GetMouseLocation()
        UpdateFromInput({Position = touchPos})
    end)
    
    return {
        Update = UpdateValue,
        GetValue = function() return value end
    }
end

-- –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ (–ü–†–û–°–¢–û–ô –ò –†–ê–ë–û–ß–ò–ô)
function ModMenu:Dropdown(parent, text, options, defaultValue, callback)
    local dropdownContainer = Create("Frame", {
        Parent = parent,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 30),
        LayoutOrder = #parent:GetChildren(),
        ClipsDescendants = true
    })
    
    Create("TextLabel", {
        Parent = dropdownContainer,
        Text = text,
        Font = Enum.Font.Gotham,
        TextSize = 14,
        TextColor3 = Color3.new(1, 1, 1),
        BackgroundTransparency = 1,
        Size = UDim2.new(0.7, 0, 1, 0),
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    local button = Create("TextButton", {
        Parent = dropdownContainer,
        Text = defaultValue or (options[1] or "–í—ã–±–µ—Ä–∏—Ç–µ..."),
        Font = Enum.Font.Gotham,
        TextSize = 14,
        TextColor3 = Color3.new(1, 1, 1),
        BackgroundColor3 = Color3.fromRGB(60, 60, 70),
        BorderSizePixel = 0,
        Size = UDim2.new(0.3, 0, 1, 0),
        Position = UDim2.new(0.7, 0, 0, 0),
        AutoButtonColor = false
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(0, 4),
        Parent = button
    })
    
    local dropdownFrame = Create("ScrollingFrame", {
        Parent = dropdownContainer,
        BackgroundColor3 = Color3.fromRGB(40, 40, 50),
        BorderSizePixel = 0,
        Size = UDim2.new(0.3, 0, 0, 0),
        Position = UDim2.new(0.7, 0, 1, 5),
        CanvasSize = UDim2.new(0, 0, 0, 0),
        ScrollBarThickness = 3,
        ScrollBarImageColor3 = Color3.fromRGB(100, 150, 255),
        Visible = false,
        ZIndex = 1000
    })
    
    local listLayout = Create("UIListLayout", {
        Parent = dropdownFrame,
        SortOrder = Enum.SortOrder.LayoutOrder
    })
    
    listLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        dropdownFrame.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y)
    end)
    
    -- –î–æ–±–∞–≤–ª—è–µ–º –æ–ø—Ü–∏–∏
    for i, option in ipairs(options) do
        local optionButton = Create("TextButton", {
            Parent = dropdownFrame,
            Text = option,
            Font = Enum.Font.Gotham,
            TextSize = 12,
            TextColor3 = Color3.new(1, 1, 1),
            BackgroundColor3 = Color3.fromRGB(50, 50, 60),
            BorderSizePixel = 0,
            Size = UDim2.new(1, 0, 0, 25),
            LayoutOrder = i,
            AutoButtonColor = false
        })
        
        Create("UICorner", {
            CornerRadius = UDim.new(0, 2),
            Parent = optionButton
        })
        
        optionButton.MouseButton1Click:Connect(function()
            button.Text = option
            if callback then
                local success, err = pcall(callback, option)
                if not success then
                    warn("–û—à–∏–±–∫–∞ –≤ dropdown: " .. tostring(err))
                end
            end
            dropdownFrame.Visible = false
        end)
        
        -- –≠—Ñ—Ñ–µ–∫—Ç—ã
        optionButton.MouseEnter:Connect(function()
            optionButton.BackgroundColor3 = Color3.fromRGB(70, 70, 80)
        end)
        
        optionButton.MouseLeave:Connect(function()
            optionButton.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
        end)
    end
    
    -- –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
    local function ToggleDropdown()
        dropdownFrame.Visible = not dropdownFrame.Visible
        if dropdownFrame.Visible then
            local height = math.min(listLayout.AbsoluteContentSize.Y, 150)
            dropdownFrame.Size = UDim2.new(0.3, 0, 0, height)
        end
    end
    
    button.MouseButton1Click:Connect(ToggleDropdown)
    button.TouchTap:Connect(ToggleDropdown)
    
    -- –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ
    local closeConnection = UserInputService.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            if dropdownFrame.Visible then
                local mousePos = input.Position
                local framePos = dropdownFrame.AbsolutePosition
                local frameSize = dropdownFrame.AbsoluteSize
                
                if mousePos.X < framePos.X or mousePos.X > framePos.X + frameSize.X or
                   mousePos.Y < framePos.Y or mousePos.Y > framePos.Y + frameSize.Y then
                    dropdownFrame.Visible = false
                end
            end
        end
    end)
    
    table.insert(self.Connections, closeConnection)
    
    -- –≠—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è –∫–Ω–æ–ø–∫–∏
    button.MouseEnter:Connect(function()
        button.BackgroundColor3 = Color3.fromRGB(80, 80, 90)
    end)
    
    button.MouseLeave:Connect(function()
        button.BackgroundColor3 = Color3.fromRGB(60, 60, 70)
    end)
    
    return {
        SetValue = function(value)
            button.Text = value
            if callback then
                pcall(callback, value)
            end
        end,
        GetValue = function() return button.Text end
    }
end

-- –ü–∞–ª–∏—Ç—Ä–∞ —Ü–≤–µ—Ç–æ–≤ (–ü–†–û–°–¢–ê–Ø –ò –†–ê–ë–û–ß–ê–Ø)
function ModMenu:ColorPicker(parent, text, defaultColor, callback)
    local pickerContainer = Create("Frame", {
        Parent = parent,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 30),
        LayoutOrder = #parent:GetChildren()
    })
    
    Create("TextLabel", {
        Parent = pickerContainer,
        Text = text,
        Font = Enum.Font.Gotham,
        TextSize = 14,
        TextColor3 = Color3.new(1, 1, 1),
        BackgroundTransparency = 1,
        Size = UDim2.new(0.7, 0, 1, 0),
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    local previewButton = Create("TextButton", {
        Parent = pickerContainer,
        Text = "",
        BackgroundColor3 = defaultColor,
        BorderSizePixel = 0,
        Size = UDim2.new(0, 40, 0, 25),
        Position = UDim2.new(0.7, 0, 0.5, -12.5),
        AutoButtonColor = false
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(0, 4),
        Parent = previewButton
    })
    
    local pickerFrame = Create("Frame", {
        Parent = pickerContainer,
        BackgroundColor3 = Color3.fromRGB(40, 40, 50),
        BorderSizePixel = 0,
        Size = UDim2.new(0, 160, 0, 100),
        Position = UDim2.new(0.7, 45, 0.5, -50),
        Visible = false,
        ZIndex = 1000
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(0, 6),
        Parent = pickerFrame
    })
    
    -- –ü—Ä–æ—Å—Ç–∞—è —Å–µ—Ç–∫–∞ —Ü–≤–µ—Ç–æ–≤
    local colors = {
        Color3.fromRGB(255, 50, 50),   -- –ö—Ä–∞—Å–Ω—ã–π
        Color3.fromRGB(255, 150, 50),  -- –û—Ä–∞–Ω–∂–µ–≤—ã–π
        Color3.fromRGB(255, 255, 50),  -- –ñ–µ–ª—Ç—ã–π
        Color3.fromRGB(50, 255, 50),   -- –ó–µ–ª–µ–Ω—ã–π
        Color3.fromRGB(50, 255, 255),  -- –ì–æ–ª—É–±–æ–π
        Color3.fromRGB(50, 150, 255),  -- –°–∏–Ω–∏–π
        Color3.fromRGB(200, 50, 255),  -- –§–∏–æ–ª–µ—Ç–æ–≤—ã–π
        Color3.fromRGB(255, 50, 200),  -- –†–æ–∑–æ–≤—ã–π
        Color3.fromRGB(255, 255, 255), -- –ë–µ–ª—ã–π
        Color3.fromRGB(200, 200, 200), -- –°–µ—Ä—ã–π
        Color3.new(0.1, 0.1, 0.1)      -- –ß–µ—Ä–Ω—ã–π
    }
    
    for i = 1, #colors do
        local colorButton = Create("TextButton", {
            Parent = pickerFrame,
            Text = "",
            BackgroundColor3 = colors[i],
            BorderSizePixel = 0,
            Size = UDim2.new(0, 30, 0, 30),
            Position = UDim2.new(0, ((i-1) % 4) * 40 + 5, 0, math.floor((i-1)/4) * 35 + 5),
            AutoButtonColor = false
        })
        
        Create("UICorner", {
            CornerRadius = UDim.new(0, 4),
            Parent = colorButton
        })
        
        colorButton.MouseButton1Click:Connect(function()
            previewButton.BackgroundColor3 = colors[i]
            if callback then
                local success, err = pcall(callback, colors[i])
                if not success then
                    warn("–û—à–∏–±–∫–∞ –≤ color picker: " .. tostring(err))
                end
            end
            pickerFrame.Visible = false
        end)
    end
    
    -- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏
    local function TogglePicker()
        pickerFrame.Visible = not pickerFrame.Visible
    end
    
    previewButton.MouseButton1Click:Connect(TogglePicker)
    previewButton.TouchTap:Connect(TogglePicker)
    
    -- –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ
    local closeConnection = UserInputService.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            if pickerFrame.Visible then
                local mousePos = input.Position
                local framePos = pickerFrame.AbsolutePosition
                local frameSize = pickerFrame.AbsoluteSize
                
                if mousePos.X < framePos.X or mousePos.X > framePos.X + frameSize.X or
                   mousePos.Y < framePos.Y or mousePos.Y > framePos.Y + frameSize.Y then
                    pickerFrame.Visible = false
                end
            end
        end
    end)
    
    table.insert(self.Connections, closeConnection)
    
    return {
        SetColor = function(color)
            previewButton.BackgroundColor3 = color
            if callback then
                pcall(callback, color)
            end
        end,
        GetColor = function() return previewButton.BackgroundColor3 end
    }
end

-- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã

function ModMenu:MakeDraggable(frame, handle)
    handle = handle or frame
    local dragging = false
    local dragStart, startPos
    
    handle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or 
           input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or 
           input.UserInputType == Enum.UserInputType.Touch) then
            local delta = input.Position - dragStart
            frame.Position = UDim2.new(
                startPos.X.Scale, startPos.X.Offset + delta.X,
                startPos.Y.Scale, startPos.Y.Offset + delta.Y
            )
        end
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or 
           input.UserInputType == Enum.UserInputType.Touch then
            dragging = false
        end
    end)
end

-- –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

function ModMenu:ToggleMenu()
    self.MenuOpen = not self.MenuOpen
    self.MenuFrame.Visible = self.MenuOpen
    
    self:UpdateFloatingTexts()
    
    if self.MenuOpen then
        self.MainButton.Text = "‚úï"
        self.MainButton.BackgroundTransparency = 0.5
    else
        self.MainButton.Text = "‚â°"
        self.MainButton.BackgroundTransparency = 0
        
        -- –ó–∞–∫—Ä—ã–≤–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç—ã
        if self.SettingsOpen then
            self.SettingsOpen = false
            self.SettingsFrame.Visible = false
            self:UpdateFloatingTexts()
        end
    end
end

function ModMenu:ToggleSettings()
    self.SettingsOpen = not self.SettingsOpen
    self.SettingsFrame.Visible = self.SettingsOpen
    
    self:UpdateFloatingTexts()
    
    if self.SettingsOpen then
        self:Notify("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç–∫—Ä—ã—Ç—ã", 1)
    end
end

function ModMenu:Notify(text, duration)
    duration = duration or 3
    
    local notification = Create("Frame", {
        Parent = self.GUI,
        BackgroundColor3 = Color3.fromRGB(30, 30, 40),
        BackgroundTransparency = 0.1,
        Size = UDim2.new(0, 300, 0, 60),
        Position = UDim2.new(1, -320, 1, -80),
        ZIndex = 10000
    })
    
    Create("UICorner", {
        CornerRadius = UDim.new(0, 8),
        Parent = notification
    })
    
    Create("TextLabel", {
        Parent = notification,
        Text = "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ",
        Font = Enum.Font.GothamBold,
        TextSize = 14,
        TextColor3 = Color3.fromRGB(100, 150, 255),
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -20, 0, 20),
        Position = UDim2.new(0, 10, 0, 5),
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    Create("TextLabel", {
        Parent = notification,
        Text = text,
        Font = Enum.Font.Gotham,
        TextSize = 12,
        TextColor3 = Color3.new(1, 1, 1),
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -20, 1, -30),
        Position = UDim2.new(0, 10, 0, 25),
        TextXAlignment = Enum.TextXAlignment.Left,
        TextWrapped = true
    })
    
    -- –ê–Ω–∏–º–∞—Ü–∏—è
    notification.Position = UDim2.new(1, 300, 1, -80)
    Tween(notification, {Position = UDim2.new(1, -320, 1, -80)})
    
    -- –£–¥–∞–ª–µ–Ω–∏–µ
    task.spawn(function()
        task.wait(duration)
        Tween(notification, {Position = UDim2.new(1, 300, 1, -80)})
        task.wait(0.3)
        notification:Destroy()
    end)
end

-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–µ–º–æ-–∫–æ–Ω—Ç–µ–Ω—Ç–∞
function ModMenu:AddDemoContent()
    local homeTab = nil
    for _, child in ipairs(self.RightPanel:GetChildren()) do
        if child.Name == "–ì–ª–∞–≤–Ω–∞—èContent" then
            homeTab = child
            break
        end
    end
    
    if homeTab then
        self:Btn(homeTab, "üëã –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ", function()
            self:Notify("–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ " .. self.MenuName .. "!", 3)
        end)
        
        self:Btn(homeTab, "üì± –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", function()
            self:Notify("–í–µ—Ä—Å–∏—è: " .. self.Version .. "\n–ê–≤—Ç–æ—Ä: –§–∞—Ç–∏–º–∞ ‚ô•Ô∏è", 4)
        end)
        
        self:Toggle(homeTab, "–î–µ–º–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å", false, function(state)
            self:Notify("–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å: " .. (state and "–í–ö–õ" or "–í–´–ö–õ"), 2)
        end)
        
        self:Slider(homeTab, "–î–µ–º–æ —Å–ª–∞–π–¥–µ—Ä", 0, 100, 50, 1, function(value)
            self:Notify("–ó–Ω–∞—á–µ–Ω–∏–µ: " .. value, 1)
        end)
        
        -- –ü—Ä–æ—Å—Ç–æ–π dropdown
        self:Dropdown(homeTab, "–î–µ–º–æ –≤—ã–±–æ—Ä", {"–í–∞—Ä–∏–∞–Ω—Ç 1", "–í–∞—Ä–∏–∞–Ω—Ç 2", "–í–∞—Ä–∏–∞–Ω—Ç 3"}, "–í–∞—Ä–∏–∞–Ω—Ç 1", function(value)
            self:Notify("–í—ã–±—Ä–∞–Ω–æ: " .. value, 2)
        end)
    end
end

-- API –º–µ—Ç–æ–¥—ã
function ModMenu:Destroy()
    -- –û—Ç–∫–ª—é—á–∞–µ–º –≤—Å–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
    for _, connection in ipairs(self.Connections) do
        if type(connection) == "userdata" and connection.Disconnect then
            pcall(function() connection:Disconnect() end)
        end
    end
    
    -- –£–Ω–∏—á—Ç–æ–∂–∞–µ–º GUI
    if self.GUI and self.GUI.Parent then
        self.GUI:Destroy()
    end
    
    self.Active = false
    self:Notify("–ú–µ–Ω—é –∑–∞–∫—Ä—ã—Ç–æ", 2)
end

function ModMenu:IsActive()
    return self.Active
end

-- –≠–∫—Å–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
local Library = {}

function Library.new(menuName)
    local menu = ModMenu.new(menuName)
    menu:AddDemoContent()
    return menu
end

-- –£—Ç–∏–ª–∏—Ç—ã
Library.Create = Create
Library.Tween = Tween
Library.Round = Round

-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
task.spawn(function()
    task.wait(1)
    print("‚úÖ Mod Menu Library v3.1 –∑–∞–≥—Ä—É–∂–µ–Ω–∞!")
    print("üë©‚Äçüíª –ê–≤—Ç–æ—Ä: –§–∞—Ç–∏–º–∞ ‚ô•Ô∏è")
end)

return Library
