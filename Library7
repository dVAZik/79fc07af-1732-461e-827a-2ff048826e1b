--[[
    Nova UI Library v4.0 - Luxury Edition
    Premium Mod Menu Framework for Roblox
    Author: Nova Team
    License: MIT
    Design: Luxury & Premium
--]]

-- Services
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")
local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")

-- Library Table
local Nova = {
    Version = "4.0",
    Debug = false,
    Instances = {},
    Themes = {}
}

Nova.__index = Nova

-- Luxury Colors
local LUXURY_COLORS = {
    Gold = Color3.fromRGB(255, 215, 0),
    Platinum = Color3.fromRGB(229, 228, 226),
    Emerald = Color3.fromRGB(80, 200, 120),
    Sapphire = Color3.fromRGB(15, 82, 186),
    Ruby = Color3.fromRGB(224, 17, 95),
    Obsidian = Color3.fromRGB(20, 20, 30),
    Velvet = Color3.fromRGB(25, 25, 40)
}

-- Premium Themes
Nova.Themes = {
    Luxury = {
        Name = "Luxury Gold",
        AccentColor = LUXURY_COLORS.Gold,
        SecondaryColor = LUXURY_COLORS.Platinum,
        Background = Color3.fromRGB(18, 18, 28),
        Surface = Color3.fromRGB(28, 28, 40),
        Surface2 = Color3.fromRGB(35, 35, 50),
        Text = Color3.fromRGB(245, 245, 250),
        SubText = Color3.fromRGB(180, 180, 200),
        Border = Color3.fromRGB(60, 60, 85),
        Hover = Color3.fromRGB(40, 40, 60),
        Shadow = Color3.new(0, 0, 0),
        Glow = Color3.fromRGB(255, 215, 0, 0.3)
    },
    Emerald = {
        Name = "Emerald",
        AccentColor = LUXURY_COLORS.Emerald,
        SecondaryColor = Color3.fromRGB(120, 220, 150),
        Background = Color3.fromRGB(15, 25, 30),
        Surface = Color3.fromRGB(25, 40, 45),
        Surface2 = Color3.fromRGB(30, 50, 55),
        Text = Color3.fromRGB(240, 250, 245),
        SubText = Color3.fromRGB(170, 200, 190),
        Border = Color3.fromRGB(50, 80, 85),
        Hover = Color3.fromRGB(35, 60, 65),
        Shadow = Color3.new(0, 0, 0),
        Glow = Color3.fromRGB(80, 200, 120, 0.3)
    },
    Sapphire = {
        Name = "Sapphire",
        AccentColor = LUXURY_COLORS.Sapphire,
        SecondaryColor = Color3.fromRGB(100, 150, 255),
        Background = Color3.fromRGB(15, 20, 35),
        Surface = Color3.fromRGB(25, 35, 55),
        Surface2 = Color3.fromRGB(30, 45, 70),
        Text = Color3.fromRGB(230, 235, 255),
        SubText = Color3.fromRGB(170, 180, 220),
        Border = Color3.fromRGB(50, 65, 100),
        Hover = Color3.fromRGB(35, 50, 80),
        Shadow = Color3.new(0, 0, 0),
        Glow = Color3.fromRGB(15, 82, 186, 0.3)
    }
}

local DEFAULT_CONFIG = {
    Theme = "Luxury",
    BackgroundTransparency = 0.15,
    BlurEnabled = true,
    Keybind = Enum.KeyCode.RightShift,
    GlowEffect = true,
    Animations = true
}

-- Safe Utility Functions
local function SafeCreate(class, props)
    local obj = Instance.new(class)
    
    for prop, value in pairs(props) do
        if prop ~= "Parent" and prop ~= "Children" then
            local success = pcall(function()
                obj[prop] = value
            end)
            if not success and Nova.Debug then
                warn("[Nova UI] Failed to set", prop, "on", class)
            end
        end
    end
    
    if props.Parent then
        obj.Parent = props.Parent
    end
    
    if props.Children then
        for _, child in ipairs(props.Children) do
            if child then
                child.Parent = obj
            end
        end
    end
    
    table.insert(Nova.Instances, obj)
    return obj
end

local function CreateTween(obj, props, duration, easing)
    if not obj or not props then return nil end
    
    local tweenInfo = TweenInfo.new(duration or 0.35, easing or Enum.EasingStyle.Quint)
    local tweenObj = TweenService:Create(obj, tweenInfo, props)
    tweenObj:Play()
    return tweenObj
end

local function GenerateId()
    return HttpService:GenerateGUID(false):sub(1, 8)
end

-- Main Constructor (SAFE)
function Nova.new(menuName)
    menuName = menuName or "NovaLux"
    
    -- Cleanup old menus
    pcall(function()
        for _, child in ipairs(CoreGui:GetChildren()) do
            if child:IsA("ScreenGui") and child.Name:find(menuName) then
                child:Destroy()
            end
        end
    end)
    
    local self = setmetatable({}, Nova)
    
    self.MenuName = menuName .. "_" .. GenerateId()
    self.Sections = {}
    self.ActiveSection = nil
    self.Config = table.clone(DEFAULT_CONFIG)
    self.CurrentTheme = Nova.Themes[self.Config.Theme] or Nova.Themes.Luxury
    self.IsMobile = UserInputService.TouchEnabled
    self.IsOpen = false
    self.Connections = {}
    
    -- Safe initialization
    local success, err = pcall(function()
        self:InitializeUI()
        self:InitializeInput()
        self:ApplyTheme()
        if self.Config.GlowEffect then
            self:CreateGlowEffect()
        end
    end)
    
    if not success then
        warn("[Nova UI] Initialization error:", err)
        return nil
    end
    
    print("[Nova UI] Luxury menu created:", self.MenuName)
    return self
end

-- Luxury UI Initialization
function Nova:InitializeUI()
    -- Main ScreenGui
    self.ScreenGui = SafeCreate("ScreenGui", {
        Name = self.MenuName,
        Parent = CoreGui,
        ResetOnSpawn = false,
        ZIndexBehavior = Enum.ZIndexBehavior.Global,
        DisplayOrder = 999
    })
    
    -- Floating Action Button (FAB)
    if self.IsMobile then
        self.FAB = SafeCreate("ImageButton", {
            Name = "FAB",
            Parent = self.ScreenGui,
            AnchorPoint = Vector2.new(1, 1),
            Position = UDim2.new(1, -30, 1, -30),
            Size = UDim2.new(0, 64, 0, 64),
            BackgroundColor3 = self.CurrentTheme.AccentColor,
            Image = "rbxassetid://10734947690",
            ImageColor3 = Color3.new(1, 1, 1),
            AutoButtonColor = false
        })
        
        local fabCorner = SafeCreate("UICorner", {
            CornerRadius = UDim.new(1, 0)
        })
        fabCorner.Parent = self.FAB
        
        local fabStroke = SafeCreate("UIStroke", {
            Color = Color3.new(1, 1, 1),
            Thickness = 2,
            Transparency = 0.2
        })
        fabStroke.Parent = self.FAB
        
        local fabShadow = SafeCreate("ImageLabel", {
            Name = "Shadow",
            Parent = self.FAB,
            Size = UDim2.new(1, 20, 1, 20),
            Position = UDim2.new(0, -10, 0, -10),
            BackgroundTransparency = 1,
            Image = "rbxassetid://5554236805",
            ImageColor3 = Color3.new(0, 0, 0),
            ImageTransparency = 0.7,
            ScaleType = Enum.ScaleType.Slice,
            SliceCenter = Rect.new(10, 10, 118, 118)
        })
        
        self.FAB.MouseButton1Click:Connect(function()
            self:Toggle()
        end)
    end
    
    -- Main Container
    self.Container = SafeCreate("Frame", {
        Name = "Container",
        Parent = self.ScreenGui,
        AnchorPoint = Vector2.new(0.5, 0.5),
        Position = UDim2.new(0.5, 0, 0.5, 0),
        Size = UDim2.new(0, 750, 0, 600),
        BackgroundTransparency = 1,
        Visible = false
    })
    
    -- Background with luxury effects
    self.Background = SafeCreate("Frame", {
        Name = "Background",
        Parent = self.Container,
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundColor3 = self.CurrentTheme.Background,
        BackgroundTransparency = 1,
        ClipsDescendants = true
    })
    
    local bgCorner = SafeCreate("UICorner", {
        CornerRadius = UDim.new(0, 20)
    })
    bgCorner.Parent = self.Background
    
    local bgStroke = SafeCreate("UIStroke", {
        Color = self.CurrentTheme.AccentColor,
        Thickness = 2,
        Transparency = 0.5
    })
    bgStroke.Parent = self.Background
    
    -- Luxury Header
    self.Header = SafeCreate("Frame", {
        Name = "Header",
        Parent = self.Background,
        Size = UDim2.new(1, 0, 0, 80),
        BackgroundColor3 = self.CurrentTheme.Surface,
        BorderSizePixel = 0
    })
    
    local headerCorner = SafeCreate("UICorner", {
        CornerRadius = UDim.new(0, 20)
    })
    headerCorner.Parent = self.Header
    
    -- Header gradient
    local headerGradient = SafeCreate("UIGradient", {
        Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, self.CurrentTheme.Surface),
            ColorSequenceKeypoint.new(0.5, self.CurrentTheme.Surface:Lerp(self.CurrentTheme.AccentColor, 0.1)),
            ColorSequenceKeypoint.new(1, self.CurrentTheme.Surface)
        }),
        Rotation = 90
    })
    headerGradient.Parent = self.Header
    
    -- Logo and Title
    self.Logo = SafeCreate("TextLabel", {
        Name = "Logo",
        Parent = self.Header,
        AnchorPoint = Vector2.new(0, 0.5),
        Position = UDim2.new(0, 30, 0.5, 0),
        Size = UDim2.new(0, 40, 0, 40),
        BackgroundTransparency = 1,
        Text = "N",
        TextColor3 = self.CurrentTheme.AccentColor,
        Font = Enum.Font.GothamBlack,
        TextSize = 32,
        TextStrokeColor3 = Color3.new(1, 1, 1),
        TextStrokeTransparency = 0.8
    })
    
    self.Title = SafeCreate("TextLabel", {
        Name = "Title",
        Parent = self.Header,
        AnchorPoint = Vector2.new(0, 0.5),
        Position = UDim2.new(0, 85, 0.5, 0),
        Size = UDim2.new(0.4, 0, 0, 40),
        BackgroundTransparency = 1,
        Text = "NOVA LUXURY",
        TextColor3 = self.CurrentTheme.Text,
        Font = Enum.Font.GothamBold,
        TextSize = 24,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    SafeCreate("TextLabel", {
        Parent = self.Header,
        AnchorPoint = Vector2.new(0, 0),
        Position = UDim2.new(0, 85, 0, 48),
        Size = UDim2.new(0.4, 0, 0, 20),
        BackgroundTransparency = 1,
        Text = "Premium Edition v" .. self.Version,
        TextColor3 = self.CurrentTheme.SubText,
        Font = Enum.Font.GothamMedium,
        TextSize = 14,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    -- Luxury Close Button
    self.CloseButton = SafeCreate("TextButton", {
        Name = "CloseButton",
        Parent = self.Header,
        AnchorPoint = Vector2.new(1, 0.5),
        Position = UDim2.new(1, -25, 0.5, 0),
        Size = UDim2.new(0, 40, 0, 40),
        BackgroundColor3 = LUXURY_COLORS.Ruby,
        AutoButtonColor = false,
        Text = "√ó",
        TextColor3 = Color3.new(1, 1, 1),
        Font = Enum.Font.GothamBlack,
        TextSize = 26
    })
    
    local closeCorner = SafeCreate("UICorner", {
        CornerRadius = UDim.new(1, 0)
    })
    closeCorner.Parent = self.CloseButton
    
    local closeStroke = SafeCreate("UIStroke", {
        Color = Color3.new(1, 1, 1),
        Thickness = 2,
        Transparency = 0.3
    })
    closeStroke.Parent = self.CloseButton
    
    self.CloseButton.MouseButton1Click:Connect(function()
        self:Toggle()
    end)
    
    -- Luxury Sidebar
    self.Sidebar = SafeCreate("Frame", {
        Name = "Sidebar",
        Parent = self.Background,
        Position = UDim2.new(0, 0, 0, 84),
        Size = UDim2.new(0, 220, 1, -84),
        BackgroundColor3 = self.CurrentTheme.Surface2,
        BorderSizePixel = 0
    })
    
    local sidebarCorner = SafeCreate("UICorner", {
        CornerRadius = UDim.new(0, 20)
    })
    sidebarCorner.Parent = self.Sidebar
    
    -- Sidebar gradient
    local sidebarGradient = SafeCreate("UIGradient", {
        Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, self.CurrentTheme.Surface2),
            ColorSequenceKeypoint.new(1, self.CurrentTheme.Surface2:Lerp(Color3.new(0, 0, 0), 0.05))
        }),
        Rotation = 90
    })
    sidebarGradient.Parent = self.Sidebar
    
    -- Section List
    self.SectionList = SafeCreate("ScrollingFrame", {
        Name = "SectionList",
        Parent = self.Sidebar,
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundTransparency = 1,
        ScrollBarThickness = 0,
        CanvasSize = UDim2.new(0, 0, 0, 0),
        AutomaticCanvasSize = Enum.AutomaticSize.Y
    })
    
    local sectionLayout = SafeCreate("UIListLayout", {
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 10)
    })
    sectionLayout.Parent = self.SectionList
    
    local sectionPadding = SafeCreate("UIPadding", {
        PaddingTop = UDim.new(0, 20),
        PaddingLeft = UDim.new(0, 20),
        PaddingRight = UDim.new(0, 20)
    })
    sectionPadding.Parent = self.SectionList
    
    -- Content Area
    self.ContentArea = SafeCreate("Frame", {
        Name = "ContentArea",
        Parent = self.Background,
        Position = UDim2.new(0, 224, 0, 84),
        Size = UDim2.new(1, -224, 1, -84),
        BackgroundTransparency = 1
    })
    
    self.ContentScroller = SafeCreate("ScrollingFrame", {
        Name = "ContentScroller",
        Parent = self.ContentArea,
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundTransparency = 1,
        ScrollBarThickness = 8,
        CanvasSize = UDim2.new(0, 0, 0, 0),
        AutomaticCanvasSize = Enum.AutomaticSize.Y,
        ScrollingDirection = Enum.ScrollingDirection.Y
    })
    
    local contentLayout = SafeCreate("UIListLayout", {
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 25)
    })
    contentLayout.Parent = self.ContentScroller
    
    local contentPadding = SafeCreate("UIPadding", {
        PaddingTop = UDim.new(0, 30),
        PaddingRight = UDim.new(0, 30),
        PaddingLeft = UDim.new(0, 30),
        PaddingBottom = UDim.new(0, 30)
    })
    contentPadding.Parent = self.ContentScroller
end

-- Glow Effect
function Nova:CreateGlowEffect()
    local glow = SafeCreate("Frame", {
        Name = "Glow",
        Parent = self.Container,
        Size = UDim2.new(1, 40, 1, 40),
        Position = UDim2.new(0, -20, 0, -20),
        BackgroundTransparency = 1,
        ZIndex = 0
    })
    
    SafeCreate("UIGradient", {
        Parent = glow,
        Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, Color3.new(0, 0, 0)),
            ColorSequenceKeypoint.new(0.5, self.CurrentTheme.AccentColor),
            ColorSequenceKeypoint.new(1, Color3.new(0, 0, 0))
        }),
        Rotation = 45,
        Transparency = NumberSequence.new({
            NumberSequenceKeypoint.new(0, 1),
            NumberSequenceKeypoint.new(0.5, 0.3),
            NumberSequenceKeypoint.new(1, 1)
        })
    })
    
    -- Animate glow
    if self.Config.Animations then
        coroutine.wrap(function()
            while glow and glow.Parent do
                CreateTween(glow, {Rotation = 360}, 10, Enum.EasingStyle.Linear)
                task.wait(10)
                glow.Rotation = 0
            end
        end)()
    end
end

-- Input Handling
function Nova:InitializeInput()
    if not self.IsMobile then
        local conn = UserInputService.InputBegan:Connect(function(input, processed)
            if not processed and input.KeyCode == self.Config.Keybind then
                self:Toggle()
            end
        end)
        table.insert(self.Connections, conn)
    end
end

-- Menu Control
function Nova:Toggle()
    self.IsOpen = not self.IsOpen
    
    if self.IsOpen then
        -- Show with luxury animation
        self.Container.Visible = true
        self.Container.Position = UDim2.new(0.5, 0, 0.5, -70)
        self.Container.BackgroundTransparency = 1
        
        CreateTween(self.Container, {
            Position = UDim2.new(0.5, 0, 0.5, 0),
            BackgroundTransparency = 0
        }, 0.6, Enum.EasingStyle.Back)
        
        CreateTween(self.Background, {
            BackgroundTransparency = self.Config.BackgroundTransparency
        }, 0.6)
        
        if self.FAB then
            CreateTween(self.FAB, {
                ImageTransparency = 0.7,
                BackgroundTransparency = 0.7
            }, 0.3)
        end
    else
        -- Hide with smooth animation
        CreateTween(self.Container, {
            Position = UDim2.new(0.5, 0, 0.5, -70),
            BackgroundTransparency = 1
        }, 0.4, Enum.EasingStyle.Quad)
        
        CreateTween(self.Background, {
            BackgroundTransparency = 1
        }, 0.4)
        
        if self.FAB then
            CreateTween(self.FAB, {
                ImageTransparency = 0,
                BackgroundTransparency = 0
            }, 0.3)
        end
        
        task.wait(0.4)
        self.Container.Visible = false
    end
end

-- Safe Section Creation (FIXED)
function Nova:Section(name, icon)
    local sectionId = #self.Sections + 1
    
    -- Create luxury sidebar button
    local button = SafeCreate("TextButton", {
        Name = name .. "Button",
        Parent = self.SectionList,
        Size = UDim2.new(1, 0, 0, 52),
        BackgroundColor3 = self.CurrentTheme.Surface2,
        AutoButtonColor = false,
        Text = "",
        LayoutOrder = sectionId
    })
    
    local buttonCorner = SafeCreate("UICorner", {
        CornerRadius = UDim.new(0, 12)
    })
    buttonCorner.Parent = button
    
    local buttonStroke = SafeCreate("UIStroke", {
        Color = self.CurrentTheme.Border,
        Thickness = 1,
        Transparency = 0.5
    })
    buttonStroke.Parent = button
    
    local buttonText = SafeCreate("TextLabel", {
        Parent = button,
        AnchorPoint = Vector2.new(0, 0.5),
        Position = UDim2.new(0, 20, 0.5, 0),
        Size = UDim2.new(1, -40, 1, 0),
        BackgroundTransparency = 1,
        Text = (icon or "‚ú®") .. "  " .. name,
        TextColor3 = self.CurrentTheme.SubText,
        Font = Enum.Font.GothamMedium,
        TextSize = 16,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    -- Create content frame
    local contentFrame = SafeCreate("Frame", {
        Name = name .. "Content",
        Parent = self.ContentScroller,
        Size = UDim2.new(1, 0, 0, 0),
        BackgroundTransparency = 1,
        LayoutOrder = sectionId,
        Visible = sectionId == 1
    })
    
    local contentLayout = SafeCreate("UIListLayout", {
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 30)
    })
    contentLayout.Parent = contentFrame
    
    contentLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        if contentFrame then
            contentFrame.Size = UDim2.new(1, 0, 0, contentLayout.AbsoluteContentSize.Y)
        end
    end)
    
    -- Set first section as active
    if sectionId == 1 then
        self.ActiveSection = contentFrame
        button.BackgroundColor3 = self.CurrentTheme.AccentColor
        buttonText.TextColor3 = Color3.new(1, 1, 1)
    end
    
    -- Button click handler
    button.MouseButton1Click:Connect(function()
        if self.ActiveSection then
            self.ActiveSection.Visible = false
        end
        
        -- Reset all buttons
        for _, btn in ipairs(self.SectionList:GetChildren()) do
            if btn:IsA("TextButton") then
                local txt = btn:FindFirstChildWhichIsA("TextLabel")
                if txt then
                    CreateTween(btn, {BackgroundColor3 = self.CurrentTheme.Surface2})
                    CreateTween(txt, {TextColor3 = self.CurrentTheme.SubText})
                end
            end
        end
        
        -- Activate selected
        if contentFrame then
            contentFrame.Visible = true
            self.ActiveSection = contentFrame
            CreateTween(button, {BackgroundColor3 = self.CurrentTheme.AccentColor})
            CreateTween(buttonText, {TextColor3 = Color3.new(1, 1, 1)})
            
            -- Scroll to top
            self.ContentScroller.CanvasPosition = Vector2.new(0, 0)
        end
    end)
    
    -- Hover effects
    button.MouseEnter:Connect(function()
        if contentFrame ~= self.ActiveSection then
            CreateTween(button, {BackgroundColor3 = self.CurrentTheme.Hover})
        end
    end)
    
    button.MouseLeave:Connect(function()
        if contentFrame ~= self.ActiveSection then
            CreateTween(button, {BackgroundColor3 = self.CurrentTheme.Surface2})
        end
    end)
    
    -- Store section
    local sectionData = {
        Name = name,
        Button = button,
        Frame = contentFrame,
        Widgets = {}
    }
    
    table.insert(self.Sections, sectionData)
    
    -- Section API
    local api = {}
    
    -- Widget Container (SAFE VERSION)
    function api:Container(title)
        if not contentFrame then return {} end
        
        local container = SafeCreate("Frame", {
            Parent = contentFrame,
            Size = UDim2.new(1, 0, 0, 0),
            BackgroundTransparency = 1,
            LayoutOrder = #contentFrame:GetChildren() + 1
        })
        
        local containerLayout = SafeCreate("UIListLayout", {
            SortOrder = Enum.SortOrder.LayoutOrder,
            Padding = UDim.new(0, 20)
        })
        containerLayout.Parent = container
        
        containerLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            if container then
                container.Size = UDim2.new(1, 0, 0, containerLayout.AbsoluteContentSize.Y)
            end
        end)
        
        if title then
            local titleFrame = SafeCreate("Frame", {
                Parent = container,
                Size = UDim2.new(1, 0, 0, 40),
                BackgroundTransparency = 1
            })
            
            local titleText = SafeCreate("TextLabel", {
                Parent = titleFrame,
                AnchorPoint = Vector2.new(0, 0.5),
                Position = UDim2.new(0, 0, 0.5, 0),
                Size = UDim2.new(1, 0, 0, 40),
                BackgroundTransparency = 1,
                Text = title,
                TextColor3 = self.CurrentTheme.AccentColor,
                Font = Enum.Font.GothamBold,
                TextSize = 20,
                TextXAlignment = Enum.TextXAlignment.Left
            })
            
            SafeCreate("Frame", {
                Parent = titleFrame,
                AnchorPoint = Vector2.new(0, 1),
                Position = UDim2.new(0, 0, 1, 0),
                Size = UDim2.new(0.4, 0, 0, 3),
                BackgroundColor3 = self.CurrentTheme.AccentColor,
                BorderSizePixel = 0
            })
        end
        
        local containerAPI = {}
        
        -- Luxury Button Widget
        function containerAPI:Button(text, callback)
            local buttonFrame = SafeCreate("Frame", {
                Parent = container,
                Size = UDim2.new(1, 0, 0, 55),
                BackgroundTransparency = 1
            })
            
            local buttonWidget = SafeCreate("TextButton", {
                Parent = buttonFrame,
                Size = UDim2.new(1, 0, 0, 55),
                BackgroundColor3 = self.CurrentTheme.Surface,
                AutoButtonColor = false,
                Text = text,
                TextColor3 = self.CurrentTheme.Text,
                Font = Enum.Font.GothamMedium,
                TextSize = 16
            })
            
            SafeCreate("UICorner", {
                CornerRadius = UDim.new(0, 12),
                Parent = buttonWidget
            })
            
            SafeCreate("UIStroke", {
                Parent = buttonWidget,
                Color = self.CurrentTheme.Border,
                Thickness = 1
            })
            
            -- Hover effect
            buttonWidget.MouseEnter:Connect(function()
                CreateTween(buttonWidget, {
                    BackgroundColor3 = self.CurrentTheme.Hover,
                    TextColor3 = self.CurrentTheme.AccentColor
                })
            end)
            
            buttonWidget.MouseLeave:Connect(function()
                CreateTween(buttonWidget, {
                    BackgroundColor3 = self.CurrentTheme.Surface,
                    TextColor3 = self.CurrentTheme.Text
                })
            end)
            
            -- Click animation
            buttonWidget.MouseButton1Click:Connect(function()
                CreateTween(buttonWidget, {
                    BackgroundColor3 = self.CurrentTheme.AccentColor,
                    TextColor3 = Color3.new(1, 1, 1)
                })
                
                task.wait(0.15)
                
                CreateTween(buttonWidget, {
                    BackgroundColor3 = self.CurrentTheme.Surface,
                    TextColor3 = self.CurrentTheme.Text
                })
                
                if callback then
                    local success, err = pcall(callback)
                    if not success and Nova.Debug then
                        warn("[Nova UI] Button error:", err)
                    end
                end
            end)
            
            return buttonWidget
        end
        
        -- Luxury Toggle Widget
        function containerAPI:Toggle(text, default, callback)
            local toggleFrame = SafeCreate("Frame", {
                Parent = container,
                Size = UDim2.new(1, 0, 0, 45),
                BackgroundTransparency = 1
            })
            
            local label = SafeCreate("TextLabel", {
                Parent = toggleFrame,
                AnchorPoint = Vector2.new(0, 0.5),
                Position = UDim2.new(0, 0, 0.5, 0),
                Size = UDim2.new(0.7, 0, 1, 0),
                BackgroundTransparency = 1,
                Text = text,
                TextColor3 = self.CurrentTheme.Text,
                Font = Enum.Font.GothamMedium,
                TextSize = 16,
                TextXAlignment = Enum.TextXAlignment.Left
            })
            
            local toggleButton = SafeCreate("TextButton", {
                Parent = toggleFrame,
                AnchorPoint = Vector2.new(1, 0.5),
                Position = UDim2.new(1, 0, 0.5, 0),
                Size = UDim2.new(0, 65, 0, 32),
                BackgroundColor3 = default and self.CurrentTheme.AccentColor or self.CurrentTheme.Surface,
                AutoButtonColor = false,
                Text = ""
            })
            
            SafeCreate("UICorner", {
                CornerRadius = UDim.new(1, 0),
                Parent = toggleButton
            })
            
            SafeCreate("UIStroke", {
                Parent = toggleButton,
                Color = self.CurrentTheme.Border,
                Thickness = 1
            })
            
            local toggleCircle = SafeCreate("Frame", {
                Parent = toggleButton,
                AnchorPoint = Vector2.new(default and 1 or 0, 0.5),
                Position = default and UDim2.new(1, -17, 0.5, 0) or UDim2.new(0, 17, 0.5, 0),
                Size = UDim2.new(0, 24, 0, 24),
                BackgroundColor3 = Color3.new(1, 1, 1)
            })
            
            SafeCreate("UICorner", {
                CornerRadius = UDim.new(1, 0),
                Parent = toggleCircle
            })
            
            SafeCreate("UIStroke", {
                Parent = toggleCircle,
                Color = self.CurrentTheme.AccentColor,
                Thickness = 2
            })
            
            local state = default or false
            
            toggleButton.MouseButton1Click:Connect(function()
                state = not state
                
                if state then
                    CreateTween(toggleButton, {BackgroundColor3 = self.CurrentTheme.AccentColor})
                    CreateTween(toggleCircle, {Position = UDim2.new(1, -17, 0.5, 0)})
                else
                    CreateTween(toggleButton, {BackgroundColor3 = self.CurrentTheme.Surface})
                    CreateTween(toggleCircle, {Position = UDim2.new(0, 17, 0.5, 0)})
                end
                
                if callback then
                    local success, err = pcall(callback, state)
                    if not success and Nova.Debug then
                        warn("[Nova UI] Toggle error:", err)
                    end
                end
            end)
            
            local toggleObj = {}
            
            function toggleObj:Set(value)
                if type(value) == "boolean" and value ~= state then
                    state = value
                    toggleButton.MouseButton1Click:Fire()
                end
                return self
            end
            
            function toggleObj:Get()
                return state
            end
            
            return toggleObj
        end
        
        -- Luxury Slider Widget
        function containerAPI:Slider(text, min, max, default, callback)
            local sliderFrame = SafeCreate("Frame", {
                Parent = container,
                Size = UDim2.new(1, 0, 0, 80),
                BackgroundTransparency = 1
            })
            
            local topRow = SafeCreate("Frame", {
                Parent = sliderFrame,
                Size = UDim2.new(1, 0, 0, 30),
                BackgroundTransparency = 1
            })
            
            local label = SafeCreate("TextLabel", {
                Parent = topRow,
                AnchorPoint = Vector2.new(0, 0.5),
                Position = UDim2.new(0, 0, 0.5, 0),
                Size = UDim2.new(0.6, 0, 1, 0),
                BackgroundTransparency = 1,
                Text = text,
                TextColor3 = self.CurrentTheme.Text,
                Font = Enum.Font.GothamMedium,
                TextSize = 16,
                TextXAlignment = Enum.TextXAlignment.Left
            })
            
            local valueLabel = SafeCreate("TextLabel", {
                Parent = topRow,
                AnchorPoint = Vector2.new(1, 0.5),
                Position = UDim2.new(1, 0, 0.5, 0),
                Size = UDim2.new(0.4, 0, 1, 0),
                BackgroundTransparency = 1,
                Text = tostring(default or min),
                TextColor3 = self.CurrentTheme.AccentColor,
                Font = Enum.Font.GothamBold,
                TextSize = 16,
                TextXAlignment = Enum.TextXAlignment.Right
            })
            
            local track = SafeCreate("Frame", {
                Parent = sliderFrame,
                Position = UDim2.new(0, 0, 0, 45),
                Size = UDim2.new(1, 0, 0, 10),
                BackgroundColor3 = self.CurrentTheme.Surface
            })
            
            SafeCreate("UICorner", {
                CornerRadius = UDim.new(1, 0),
                Parent = track
            })
            
            SafeCreate("UIStroke", {
                Parent = track,
                Color = self.CurrentTheme.Border,
                Thickness = 1
            })
            
            local fill = SafeCreate("Frame", {
                Parent = track,
                Size = UDim2.new(0, 0, 1, 0),
                BackgroundColor3 = self.CurrentTheme.AccentColor
            })
            
            SafeCreate("UICorner", {
                CornerRadius = UDim.new(1, 0),
                Parent = fill
            })
            
            local handle = SafeCreate("Frame", {
                Parent = track,
                AnchorPoint = Vector2.new(0.5, 0.5),
                Position = UDim2.new(0, 0, 0.5, 0),
                Size = UDim2.new(0, 28, 0, 28),
                BackgroundColor3 = Color3.new(1, 1, 1),
                ZIndex = 2
            })
            
            SafeCreate("UICorner", {
                CornerRadius = UDim.new(1, 0),
                Parent = handle
            })
            
            SafeCreate("UIStroke", {
                Parent = handle,
                Color = self.CurrentTheme.AccentColor,
                Thickness = 3
            })
            
            local value = math.clamp(default or min, min, max)
            local dragging = false
            
            local function updateSlider(mouseX)
                local absoluteX = track.AbsolutePosition.X
                local absoluteWidth = track.AbsoluteSize.X
                
                if not absoluteX or not absoluteWidth then return end
                
                local relativeX = math.clamp(mouseX - absoluteX, 0, absoluteWidth)
                local percentage = relativeX / absoluteWidth
                value = math.floor(min + (max - min) * percentage)
                
                fill.Size = UDim2.new(percentage, 0, 1, 0)
                handle.Position = UDim2.new(percentage, 0, 0.5, 0)
                valueLabel.Text = tostring(value)
                
                if callback then
                    local success, err = pcall(callback, value)
                    if not success and Nova.Debug then
                        warn("[Nova UI] Slider error:", err)
                    end
                end
            end
            
            -- Set initial value
            local initialPercentage = (value - min) / (max - min)
            fill.Size = UDim2.new(initialPercentage, 0, 1, 0)
            handle.Position = UDim2.new(initialPercentage, 0, 0.5, 0)
            
            -- Input handlers
            handle.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    dragging = true
                end
            end)
            
            handle.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    dragging = false
                end
            end)
            
            track.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    dragging = true
                    updateSlider(input.Position.X)
                end
            end)
            
            local conn = UserInputService.InputChanged:Connect(function(input)
                if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                    updateSlider(input.Position.X)
                end
            end)
            
            table.insert(self.Connections, conn)
            
            local sliderObj = {}
            
            function sliderObj:Set(newValue)
                value = math.clamp(newValue, min, max)
                local percentage = (value - min) / (max - min)
                fill.Size = UDim2.new(percentage, 0, 1, 0)
                handle.Position = UDim2.new(percentage, 0, 0.5, 0)
                valueLabel.Text = tostring(value)
                return self
            end
            
            function sliderObj:Get()
                return value
            end
            
            return sliderObj
        end
        
        -- Luxury Dropdown Widget
        function containerAPI:Dropdown(text, options, callback)
            local dropdownFrame = SafeCreate("Frame", {
                Parent = container,
                Size = UDim2.new(1, 0, 0, 55),
                BackgroundTransparency = 1
            })
            
            local label = SafeCreate("TextLabel", {
                Parent = dropdownFrame,
                AnchorPoint = Vector2.new(0, 0.5),
                Position = UDim2.new(0, 0, 0.5, 0),
                Size = UDim2.new(0.3, 0, 1, 0),
                BackgroundTransparency = 1,
                Text = text,
                TextColor3 = self.CurrentTheme.Text,
                Font = Enum.Font.GothamMedium,
                TextSize = 16,
                TextXAlignment = Enum.TextXAlignment.Left
            })
            
            local dropdownButton = SafeCreate("TextButton", {
                Parent = dropdownFrame,
                AnchorPoint = Vector2.new(1, 0.5),
                Position = UDim2.new(1, 0, 0.5, 0),
                Size = UDim2.new(0.7, 0, 1, 0),
                BackgroundColor3 = self.CurrentTheme.Surface,
                AutoButtonColor = false,
                Text = "Select...",
                TextColor3 = self.CurrentTheme.SubText,
                Font = Enum.Font.GothamMedium,
                TextSize = 16
            })
            
            SafeCreate("UICorner", {
                CornerRadius = UDim.new(0, 12),
                Parent = dropdownButton
            })
            
            SafeCreate("UIStroke", {
                Parent = dropdownButton,
                Color = self.CurrentTheme.Border,
                Thickness = 1
            })
            
            local dropdownList = SafeCreate("Frame", {
                Parent = self.ScreenGui,
                Size = UDim2.new(0, 240, 0, 0),
                BackgroundColor3 = self.CurrentTheme.Surface2,
                Visible = false,
                ZIndex = 100,
                ClipsDescendants = true
            })
            
            SafeCreate("UICorner", {
                CornerRadius = UDim.new(0, 12),
                Parent = dropdownList
            })
            
            SafeCreate("UIStroke", {
                Parent = dropdownList,
                Color = self.CurrentTheme.AccentColor,
                Thickness = 2
            })
            
            SafeCreate("UIListLayout", {
                Parent = dropdownList,
                SortOrder = Enum.SortOrder.LayoutOrder
            })
            
            local selected = nil
            
            local function updateList()
                for _, child in ipairs(dropdownList:GetChildren()) do
                    if child:IsA("TextButton") then
                        child:Destroy()
                    end
                end
                
                for i, option in ipairs(options) do
                    local optionText = tostring(option)
                    local optionButton = SafeCreate("TextButton", {
                        Parent = dropdownList,
                        Size = UDim2.new(1, -10, 0, 45),
                        Position = UDim2.new(0, 5, 0, (i-1)*50 + 5),
                        BackgroundColor3 = self.CurrentTheme.Surface2,
                        AutoButtonColor = false,
                        Text = optionText,
                        TextColor3 = self.CurrentTheme.Text,
                        Font = Enum.Font.Gotham,
                        TextSize = 15
                    })
                    
                    SafeCreate("UICorner", {
                        CornerRadius = UDim.new(0, 10),
                        Parent = optionButton
                    })
                    
                    optionButton.MouseEnter:Connect(function()
                        CreateTween(optionButton, {BackgroundColor3 = self.CurrentTheme.Hover})
                    end)
                    
                    optionButton.MouseLeave:Connect(function()
                        CreateTween(optionButton, {BackgroundColor3 = self.CurrentTheme.Surface2})
                    end)
                    
                    optionButton.MouseButton1Click:Connect(function()
                        selected = option
                        dropdownButton.Text = optionText
                        dropdownButton.TextColor3 = self.CurrentTheme.AccentColor
                        dropdownList.Visible = false
                        
                        if callback then
                            local success, err = pcall(callback, option)
                            if not success and Nova.Debug then
                                warn("[Nova UI] Dropdown error:", err)
                            end
                        end
                    end)
                end
                
                dropdownList.Size = UDim2.new(0, 240, 0, math.min(#options * 50, 220))
            end
            
            dropdownButton.MouseButton1Click:Connect(function()
                local buttonPos = dropdownButton.AbsolutePosition
                local buttonSize = dropdownButton.AbsoluteSize
                
                dropdownList.Position = UDim2.new(
                    0, buttonPos.X,
                    0, buttonPos.Y + buttonSize.Y + 5
                )
                
                dropdownList.Visible = not dropdownList.Visible
                updateList()
            end)
            
            updateList()
            
            local dropdownObj = {}
            
            function dropdownObj:SetOptions(newOptions)
                if type(newOptions) == "table" then
                    options = newOptions
                    updateList()
                end
                return self
            end
            
            function dropdownObj:Set(value)
                selected = value
                dropdownButton.Text = tostring(value)
                dropdownButton.TextColor3 = self.CurrentTheme.AccentColor
                return self
            end
            
            function dropdownObj:Get()
                return selected
            end
            
            return dropdownObj
        end
        
        -- Luxury Textbox Widget
        function containerAPI:Textbox(text, placeholder, callback)
            local textboxFrame = SafeCreate("Frame", {
                Parent = container,
                Size = UDim2.new(1, 0, 0, 55),
                BackgroundTransparency = 1
            })
            
            local label = SafeCreate("TextLabel", {
                Parent = textboxFrame,
                AnchorPoint = Vector2.new(0, 0.5),
                Position = UDim2.new(0, 0, 0.5, 0),
                Size = UDim2.new(0.3, 0, 1, 0),
                BackgroundTransparency = 1,
                Text = text,
                TextColor3 = self.CurrentTheme.Text,
                Font = Enum.Font.GothamMedium,
                TextSize = 16,
                TextXAlignment = Enum.TextXAlignment.Left
            })
            
            local textbox = SafeCreate("TextBox", {
                Parent = textboxFrame,
                AnchorPoint = Vector2.new(1, 0.5),
                Position = UDim2.new(1, 0, 0, 0),
                Size = UDim2.new(0.7, 0, 1, 0),
                BackgroundColor3 = self.CurrentTheme.Surface,
                PlaceholderText = placeholder or "Enter text...",
                Text = "",
                TextColor3 = self.CurrentTheme.Text,
                Font = Enum.Font.Gotham,
                TextSize = 15,
                ClearTextOnFocus = false
            })
            
            SafeCreate("UICorner", {
                CornerRadius = UDim.new(0, 12),
                Parent = textbox
            })
            
            SafeCreate("UIStroke", {
                Parent = textbox,
                Color = self.CurrentTheme.Border,
                Thickness = 1
            })
            
            if callback then
                textbox.FocusLost:Connect(function(enterPressed)
                    local success, err = pcall(callback, textbox.Text, enterPressed)
                    if not success and Nova.Debug then
                        warn("[Nova UI] Textbox error:", err)
                    end
                end)
            end
            
            return textbox
        end
        
        return containerAPI
    end
    
    -- Direct widget methods (simplified API)
    function api:Button(text, callback)
        local container = api:Container()
        return container and container:Button(text, callback)
    end
    
    function api:Toggle(text, default, callback)
        local container = api:Container()
        return container and container:Toggle(text, default, callback)
    end
    
    function api:Slider(text, min, max, default, callback)
        local container = api:Container()
        return container and container:Slider(text, min, max, default, callback)
    end
    
    function api:Dropdown(text, options, callback)
        local container = api:Container()
        return container and container:Dropdown(text, options, callback)
    end
    
    function api:Textbox(text, placeholder, callback)
        local container = api:Container()
        return container and container:Textbox(text, placeholder, callback)
    end
    
    return api
end

-- Luxury Console System
function Nova:CreateConsoleSection()
    local console = self:Section("Console", "üìä")
    
    local mainContainer = console:Container("System Console")
    
    -- Search bar
    mainContainer:Textbox("Search Logs", "Type to filter...", function(text)
        print("Searching for:", text)
    end)
    
    -- Console output
    local outputFrame = SafeCreate("Frame", {
        Parent = mainContainer,
        Size = UDim2.new(1, 0, 0, 320),
        BackgroundColor3 = Color3.fromRGB(15, 20, 30),
        LayoutOrder = 2
    })
    
    SafeCreate("UICorner", {
        CornerRadius = UDim.new(0, 15),
        Parent = outputFrame
    })
    
    SafeCreate("UIStroke", {
        Parent = outputFrame,
        Color = self.CurrentTheme.AccentColor,
        Thickness = 2,
        Transparency = 0.3
    })
    
    local outputScroller = SafeCreate("ScrollingFrame", {
        Parent = outputFrame,
        Size = UDim2.new(1, -20, 1, -20),
        Position = UDim2.new(0, 10, 0, 10),
        BackgroundTransparency = 1,
        ScrollBarThickness = 8,
        CanvasSize = UDim2.new(0, 0, 0, 0),
        AutomaticCanvasSize = Enum.AutomaticSize.Y
    })
    
    SafeCreate("UIListLayout", {
        Parent = outputScroller,
        SortOrder = Enum.SortOrder.LayoutOrder
    })
    
    -- Sample logs
    local logs = {
        {text = "[Nova UI] Luxury menu created: " .. self.MenuName, color = LUXURY_COLORS.Emerald},
        {text = "‚úÖ Nova UI —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!", color = LUXURY_COLORS.Emerald},
        {text = "System initialized successfully", color = LUXURY_COLORS.Sapphire},
        {text = "Connected to game server", color = LUXURY_COLORS.Sapphire},
        {text = "HTTP 404 - Resource not found", color = LUXURY_COLORS.Ruby},
        {text = "Stack Begin", color = Color3.fromRGB(150, 150, 180)},
        {text = "Script 'LocalScript', Line 2051", color = Color3.fromRGB(180, 180, 210)},
        {text = "Stack End", color = Color3.fromRGB(150, 150, 180)},
        {text = "", color = Color3.fromRGB(200, 200, 200)},
        {text = "[30 EXP] [30 BELI] - Rewards received", color = LUXURY_COLORS.Gold},
        {text = "[TIME 00:45:55] - Session duration", color = Color3.fromRGB(100, 150, 255)}
    }
    
    for i, log in ipairs(logs) do
        local logLabel = SafeCreate("TextLabel", {
            Parent = outputScroller,
            Size = UDim2.new(1, 0, 0, 22),
            BackgroundTransparency = 1,
            Text = log.text,
            TextColor3 = log.color,
            Font = Enum.Font.RobotoMono,
            TextSize = 14,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextTruncate = Enum.TextTruncate.AtEnd,
            LayoutOrder = i
        })
    end
    
    -- Console controls
    local controls = console:Container("Console Controls")
    
    controls:Button("üîÑ Clear Console", function()
        for _, child in ipairs(outputScroller:GetChildren()) do
            if child:IsA("TextLabel") then
                child:Destroy()
            end
        end
        print("Console cleared")
    end)
    
    controls:Button("üíæ Save Logs", function()
        print("Logs saved to file")
    end)
    
    controls:Button("üìã Copy to Clipboard", function()
        print("Logs copied to clipboard")
    end)
end

-- Luxury Settings Section
function Nova:AddSettingsSection()
    local settings = self:Section("Settings", "‚öôÔ∏è")
    
    -- UI Settings
    local uiSettings = settings:Container("UI Configuration")
    
    local themeOptions = {}
    for name, theme in pairs(Nova.Themes) do
        table.insert(themeOptions, theme.Name)
    end
    
    local themeDropdown = uiSettings:Dropdown("Theme", themeOptions, function(themeName)
        for name, theme in pairs(Nova.Themes) do
            if theme.Name == themeName then
                self.Config.Theme = name
                self.CurrentTheme = theme
                self:ApplyTheme()
                break
            end
        end
    end)
    
    themeDropdown:Set(self.CurrentTheme.Name)
    
    uiSettings:Slider("Transparency", 0, 100, 85, function(value)
        self.Config.BackgroundTransparency = 1 - (value / 100)
        self.Background.BackgroundTransparency = self.Config.BackgroundTransparency
    end)
    
    uiSettings:Toggle("Glow Effects", self.Config.GlowEffect, function(state)
        self.Config.GlowEffect = state
        if state then
            self:CreateGlowEffect()
        else
            local glow = self.Container:FindFirstChild("Glow")
            if glow then
                glow:Destroy()
            end
        end
    end)
    
    uiSettings:Toggle("Animations", self.Config.Animations, function(state)
        self.Config.Animations = state
    end)
    
    -- Keybind Settings
    local inputSettings = settings:Container("Input Settings")
    
    inputSettings:Button("Current Keybind: " .. self.Config.Keybind.Name, function()
        print("üîë Press any key to set new keybind...")
    end)
    
    -- System Settings
    local systemSettings = settings:Container("System")
    
    systemSettings:Button("üîÑ Reset to Defaults", function()
        self.Config = table.clone(DEFAULT_CONFIG)
        self.CurrentTheme = Nova.Themes[self.Config.Theme]
        self:ApplyTheme()
        print("Settings reset to luxury defaults")
    end)
    
    systemSettings:Button("üóëÔ∏è Destroy Menu", function()
        self:Destroy()
        print("Luxury menu destroyed")
    end)
    
    -- Information
    local infoSettings = settings:Container("Information")
    
    infoSettings:Button("Nova UI Luxury v" .. self.Version, function()
        print("üíé Nova UI Luxury Edition v" .. self.Version)
        print("‚ú® Premium Mod Menu Framework")
        print("üé® Designed for elegance and performance")
    end)
    
    infoSettings:Button("About", function()
        print("Created with üíñ by Nova Team")
        print("License: MIT")
        print("Special thanks to all contributors")
    end)
end

-- Apply Theme (SAFE)
function Nova:ApplyTheme()
    if not self.CurrentTheme then return end
    
    -- Safely update all UI elements
    if self.Background then
        self.Background.BackgroundColor3 = self.CurrentTheme.Background
    end
    
    if self.Header then
        self.Header.BackgroundColor3 = self.CurrentTheme.Surface
    end
    
    if self.Title then
        self.Title.TextColor3 = self.CurrentTheme.Text
    end
    
    if self.Logo then
        self.Logo.TextColor3 = self.CurrentTheme.AccentColor
    end
    
    if self.CloseButton then
        self.CloseButton.BackgroundColor3 = LUXURY_COLORS.Ruby
    end
    
    if self.Sidebar then
        self.Sidebar.BackgroundColor3 = self.CurrentTheme.Surface2
    end
    
    if self.FAB then
        self.FAB.BackgroundColor3 = self.CurrentTheme.AccentColor
    end
    
    -- Update all section buttons
    for _, section in ipairs(self.Sections) do
        if section.Button then
            local textLabel = section.Button:FindFirstChildWhichIsA("TextLabel")
            if textLabel then
                if section.Frame == self.ActiveSection then
                    section.Button.BackgroundColor3 = self.CurrentTheme.AccentColor
                    textLabel.TextColor3 = Color3.new(1, 1, 1)
                else
                    section.Button.BackgroundColor3 = self.CurrentTheme.Surface2
                    textLabel.TextColor3 = self.CurrentTheme.SubText
                end
            end
        end
    end
end

-- Cleanup
function Nova:Destroy()
    -- Disconnect all connections
    for _, conn in ipairs(self.Connections) do
        if typeof(conn) == "RBXScriptConnection" then
            pcall(function() conn:Disconnect() end)
        end
    end
    
    -- Destroy screen gui
    if self.ScreenGui then
        pcall(function() self.ScreenGui:Destroy() end)
    end
    
    -- Clear all instances
    for _, instance in ipairs(Nova.Instances) do
        pcall(function() instance:Destroy() end)
    end
    
    -- Clear tables
    table.clear(Nova.Instances)
    table.clear(self.Connections)
    table.clear(self.Sections)
    
    -- Clear self
    for k in pairs(self) do
        self[k] = nil
    end
    
    print("[Nova UI] Luxury menu destroyed")
end

return Nova
